Description: CVE-2020-10543
 heap-based buffer overflow
---
Author: Abhijith PA <abhijith@debian.org>
Origin: https://github.com/perl/perl5/commit/897d1f7fd515b828e4b198d8b8bef76c6faf03ed
Bug-Debian: https://bugs.debian.org/962005
Last-Update: 2020-06-18

--- a/regcomp.c
+++ b/regcomp.c
@@ -4505,6 +4505,13 @@ S_study_chunk(pTHX_ RExC_state_t *pRExC_
 		    (void)ReREFCNT_inc(RExC_rx_sv);
 		}
 
+		if ( ( minnext > 0 && mincount >= SSize_t_MAX / minnext )
+                    || min >= SSize_t_MAX - minnext * mincount )
+                {
+                    FAIL("Regexp out of space");
+                }
+
+
 		min += minnext * mincount;
 		is_inf_internal |= deltanext == SSize_t_MAX
                          || (maxcount == REG_INFTY && minnext + deltanext > 0);
